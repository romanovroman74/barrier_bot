# Barrier Bot

Это телеграм-бот, позволяющий зарегистрированным пользователям по команде открывать шлагбаум (или выполнять другой запрограммированный вызов).

## Оглавление

1. [Особенности и функциональность](#особенности-и-функциональность)  
2. [Требования](#требования)  
3. [Установка и настройка](#установка-и-настройка)  
4. [Структура проекта](#структура-проекта)  
5. [Использование](#использование)  
6. [Дополнительно](#дополнительно)

---

## Особенности и функциональность

- **Регистрация пользователя**  
  При запуске бота (`/start`) проверяется, есть ли пользователь в базе данных.  
  Если пользователя нет, бот запрашивает номер телефона и сохраняет данные в базе (MySQL).

- **Открытие шлагбаума**  
  Зарегистрированный пользователь может отправить команду `/open`, после чего вызывается функция, совершающая звонок или отправляющая сигнал на указанный в `config` номер (`config.barrier_phone`).

- **Работа с базой данных**  
  Используется модуль `mysql_handler` для взаимодействия с MySQL (проверка и добавление пользователей).

- **Обработка ошибок**  
  При проблемах с подключением к базе или другими неполадками бот отправит пользователю сообщение об ошибке.

---

## Требования

- Python 3.6+ (рекомендуется последняя стабильная версия Python 3)
- Установленные библиотеки (PyTelegramBotAPI и др.)  
- Настроенная база данных MySQL (или совместимая)
- Токен телеграм-бота (от BotFather)
- Корректный номер / способ вызова `barrier_phone` (в `config.py`), который используется для фактического открытия шлагбаума

---

## Установка и настройка

1. **Клонировать репозиторий** (или скачать и распаковать):
   ```bash
   git clone https://github.com/your_username/barrier_bot.git
   cd barrier_bot
   ```

2. **Создать виртуальное окружение** (рекомендуется):
   ```bash
   python -m venv venv
   source venv/bin/activate        # для Linux/macOS
   venv\Scripts\activate           # для Windows
   ```

3. **Установить зависимости:**
   ```bash
   pip install -r requirements.txt
   ```

4. **Настроить файл `config.py`:**
   ```python
   token = "YOUR_TELEGRAM_BOT_TOKEN"
   barrier_phone = "PHONE_NUMBER_OR_ENDPOINT"
   ```

5. **Настроить базу данных в `mysql_handler.py`** (параметры подключения и функции для проверки и добавления пользователей).

6. **Запустить бота:**
   ```bash
   python barrier_bot.py
   ```

---

## Структура проекта

```
barrier_bot/
├── barrier_bot.py         # Основной файл для запуска бота
├── mysql_handler.py       # Модуль для работы с MySQL
├── uis_handler.py         # Модуль для управления шлагбаумом
├── config.py              # Конфигурационный файл (токен, телефон)
├── .gitignore             # Исключенные файлы (__pycache__, config.py и т.д.)
└── requirements.txt       # Список зависимостей
```

---

## Использование

1. **Запуск бота:**
   ```bash
   python barrier_bot.py
   ```

2. **Взаимодействие с ботом в Telegram:**
   - Отправьте команду `/start` для регистрации или входа.
   - Отправьте команду `/open` для открытия шлагбаума.

3. **Если бот не отвечает, проверьте лог в консоли на наличие ошибок.**

---

## Дополнительно

- **Файл `.gitignore`**  
  Добавьте в репозиторий, чтобы исключить:
  ```gitignore
  __pycache__/
  config.py
  ```

- **Рекомендации по безопасности:**  
  Не храните чувствительные данные в репозитории.

---

**Надеемся, этот бот поможет вам упростить процесс управления доступом к шлагбауму!**

